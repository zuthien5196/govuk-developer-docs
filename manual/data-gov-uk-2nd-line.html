


<!doctype html>
<html lang="en" class="govuk-template no-js">
  <head>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>Common 2nd line support tasks for data.gov.uk - GOV.UK Developer Documentation</title>

    <link href="/stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://docs.publishing.service.gov.uk/manual/data-gov-uk-2nd-line.html">


      <meta property="og:image" content="https://docs.publishing.service.gov.uk/images/govuk-large.png" />
      <meta property="og:site_name" content="GOV.UK Developer Documentation" />
      <meta property="og:title" content="Common 2nd line support tasks for data.gov.uk" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://docs.publishing.service.gov.uk/manual/data-gov-uk-2nd-line.html" />
      <meta property="twitter:card" content="summary" />
      <meta property="twitter:domain" content="docs.publishing.service.gov.uk" />
      <meta property="twitter:image" content="https://docs.publishing.service.gov.uk/images/govuk-large.png" />
      <meta property="twitter:title" content="Common 2nd line support tasks for data.gov.uk - GOV.UK Developer Documentation" />
      <meta property="twitter:url" content="https://docs.publishing.service.gov.uk/manual/data-gov-uk-2nd-line.html" />

    
  </head>

  <body class="govuk-template__body">
    <script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>

    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="/" class="govuk-header__link govuk-header__link--homepage">
        <span class="govuk-header__logotype">
          <svg
            aria-hidden="true"
            focusable="false"
            class="govuk-header__logotype-crown"
            xmlns="http://www.w3.org/2000/svg"
            viewbox="0 0 132 97"
            height="30"
            width="36"
          >
            <path
              fill="currentColor" fill-rule="evenodd"
              d="M25 30.2c3.5 1.5 7.7-.2 9.1-3.7 1.5-3.6-.2-7.8-3.9-9.2-3.6-1.4-7.6.3-9.1 3.9-1.4 3.5.3 7.5 3.9 9zM9 39.5c3.6 1.5 7.8-.2 9.2-3.7 1.5-3.6-.2-7.8-3.9-9.1-3.6-1.5-7.6.2-9.1 3.8-1.4 3.5.3 7.5 3.8 9zM4.4 57.2c3.5 1.5 7.7-.2 9.1-3.8 1.5-3.6-.2-7.7-3.9-9.1-3.5-1.5-7.6.3-9.1 3.8-1.4 3.5.3 7.6 3.9 9.1zm38.3-21.4c3.5 1.5 7.7-.2 9.1-3.8 1.5-3.6-.2-7.7-3.9-9.1-3.6-1.5-7.6.3-9.1 3.8-1.3 3.6.4 7.7 3.9 9.1zm64.4-5.6c-3.6 1.5-7.8-.2-9.1-3.7-1.5-3.6.2-7.8 3.8-9.2 3.6-1.4 7.7.3 9.2 3.9 1.3 3.5-.4 7.5-3.9 9zm15.9 9.3c-3.6 1.5-7.7-.2-9.1-3.7-1.5-3.6.2-7.8 3.7-9.1 3.6-1.5 7.7.2 9.2 3.8 1.5 3.5-.3 7.5-3.8 9zm4.7 17.7c-3.6 1.5-7.8-.2-9.2-3.8-1.5-3.6.2-7.7 3.9-9.1 3.6-1.5 7.7.3 9.2 3.8 1.3 3.5-.4 7.6-3.9 9.1zM89.3 35.8c-3.6 1.5-7.8-.2-9.2-3.8-1.4-3.6.2-7.7 3.9-9.1 3.6-1.5 7.7.3 9.2 3.8 1.4 3.6-.3 7.7-3.9 9.1zM69.7 17.7l8.9 4.7V9.3l-8.9 2.8c-.2-.3-.5-.6-.9-.9L72.4 0H59.6l3.5 11.2c-.3.3-.6.5-.9.9l-8.8-2.8v13.1l8.8-4.7c.3.3.6.7.9.9l-5 15.4v.1c-.2.8-.4 1.6-.4 2.4 0 4.1 3.1 7.5 7 8.1h.2c.3 0 .7.1 1 .1.4 0 .7 0 1-.1h.2c4-.6 7.1-4.1 7.1-8.1 0-.8-.1-1.7-.4-2.4V34l-5.1-15.4c.4-.2.7-.6 1-.9zM66 92.8c16.9 0 32.8 1.1 47.1 3.2 4-16.9 8.9-26.7 14-33.5l-9.6-3.4c1 4.9 1.1 7.2 0 10.2-1.5-1.4-3-4.3-4.2-8.7L108.6 76c2.8-2 5-3.2 7.5-3.3-4.4 9.4-10 11.9-13.6 11.2-4.3-.8-6.3-4.6-5.6-7.9 1-4.7 5.7-5.9 8-.5 4.3-8.7-3-11.4-7.6-8.8 7.1-7.2 7.9-13.5 2.1-21.1-8 6.1-8.1 12.3-4.5 20.8-4.7-5.4-12.1-2.5-9.5 6.2 3.4-5.2 7.9-2 7.2 3.1-.6 4.3-6.4 7.8-13.5 7.2-10.3-.9-10.9-8-11.2-13.8 2.5-.5 7.1 1.8 11 7.3L80.2 60c-4.1 4.4-8 5.3-12.3 5.4 1.4-4.4 8-11.6 8-11.6H55.5s6.4 7.2 7.9 11.6c-4.2-.1-8-1-12.3-5.4l1.4 16.4c3.9-5.5 8.5-7.7 10.9-7.3-.3 5.8-.9 12.8-11.1 13.8-7.2.6-12.9-2.9-13.5-7.2-.7-5 3.8-8.3 7.1-3.1 2.7-8.7-4.6-11.6-9.4-6.2 3.7-8.5 3.6-14.7-4.6-20.8-5.8 7.6-5 13.9 2.2 21.1-4.7-2.6-11.9.1-7.7 8.8 2.3-5.5 7.1-4.2 8.1.5.7 3.3-1.3 7.1-5.7 7.9-3.5.7-9-1.8-13.5-11.2 2.5.1 4.7 1.3 7.5 3.3l-4.7-15.4c-1.2 4.4-2.7 7.2-4.3 8.7-1.1-3-.9-5.3 0-10.2l-9.5 3.4c5 6.9 9.9 16.7 14 33.5 14.8-2.1 30.8-3.2 47.7-3.2z"
            ></path>
            <image src="/assets/images/govuk-logotype-crown.png" xlink:href="" class="govuk-header__logotype-crown-fallback-image" width="36" height="32"></image>
          </svg>
          <span class="govuk-header__logotype-text">
            GOV.UK
          </span>
        </span>
        <span class="govuk-header__product-name">
          Developer docs
        </span>
      </a>
    </div>
    <div class="govuk-header__content">
      <button type="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" aria-label="Show or hide Top Level Navigation">Menu</button>
      <nav>
        <ul id="navigation" class="govuk-header__navigation govuk-header__navigation--end" aria-label="Top Level Navigation">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/">Dashboard</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual/get-started.html">Get started</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/apps.html">Apps</a>
            </li>
            <li class="govuk-header__navigation-item govuk-header__navigation-item--active">
              <a class="govuk-header__link" href="/manual.html">Manual</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/apis.html">APIs</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/content-schemas.html">Schemas</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/document-types.html">Document types</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <a href="#toc" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </a>
        </div>

      <div class="app-pane__body">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents">
              <div class="search" data-module="search">
  <form action="https://www.google.co.uk/search" method="get" role="search">
    <input type="hidden" name="as_sitesearch" value="https://docs.publishing.service.gov.uk"/>
    <label class="govuk-label search__label" for="search">
      Search (via Google)
    </label>
    <input class="govuk-input govuk-!-margin-bottom-4" id="search" name="q" type="text" aria-controls="search-results" placeholder="Search">
  </form>
  <div id="search-results" class="search-results" aria-hidden="true" role="dialog" aria-labelledby="search-results-title">
    <div class="search-results__inner">
      <button class="search-results__close">Close<span class="search-results__close-label"> search results</span></button>
      <h2 id="search-results-title" class="search-results__title" aria-live="polite">Results</h2>
      <div class="search-results__content"></div>
    </div>
  </div>
</div>

              <a href="#" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></a>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                  <a href='/manual.html' class="toc__back-link govuk-link">&lsaquo; Manual</a>
  <ul>
  <li>
    <a href="#header"><span>Common 2nd line support tasks for data.gov.uk</span></a>
    <ul>
      <li>
        <a href="#users-and-publishers"><span>Users and Publishers</span></a>
        <ul>
          <li>
            <a href="#find-a-user"><span>Find a user</span></a>
          </li>
          <li>
            <a href="#create-a-user-account"><span>Create a user account</span></a>
          </li>
          <li>
            <a href="#update-a-user-account-email-address"><span>Update a user account email address</span></a>
          </li>
          <li>
            <a href="#create-a-publishing-organisation"><span>Create a publishing organisation</span></a>
          </li>
          <li>
            <a href="#assign-users-to-publishers-setting-user-permissions"><span>Assign users to publishers (setting user permissions)</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#datasets"><span>Datasets</span></a>
        <ul>
          <li>
            <a href="#delete-or-withdraw-a-dataset"><span>Delete or withdraw a dataset</span></a>
          </li>
          <li>
            <a href="#a-dataset-is-wrong-in-some-way"><span>A dataset is wrong in some way</span></a>
          </li>
          <li>
            <a href="#different-number-of-datasets-in-ckan-app-to-find"><span>Different number of datasets in CKAN-app to Find</span></a>
          </li>
          <li>
            <a href="#datasets-published-in-ckan-are-not-appearing-on-find"><span>Datasets published in CKAN are not appearing on Find</span></a>
          </li>
          <li>
            <a href="#accessing-withdrawn-content"><span>Accessing withdrawn content</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#schema-vocabulary-definitions"><span>Schema vocabulary definitions</span></a>
        <ul>
          <li>
            <a href="#add-a-schema-vocabulary-definition"><span>Add a schema vocabulary definition</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#harvesting"><span>Harvesting</span></a>
      </li>
      <li>
        <a href="#map-previews-issues"><span>Map previews issues</span></a>
      </li>
      <li>
        <a href="#organogram-publishing"><span>Organogram Publishing</span></a>
        <ul>
          <li>
            <a href="#xls-to-csv-conversion"><span>XLS to CSV Conversion</span></a>
          </li>
          <li>
            <a href="#dataset-analytics-requests"><span>Dataset Analytics requests</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#revision-log"><span>Revision log</span></a>
      </li>
    </ul>
  </li>
</ul>


              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
            
  <p><a href='/manual.html#data-gov-uk'>data.gov.uk</a></p> <h1 id='header'>Common 2nd line support tasks for data.gov.uk</h1><p>This document details some of the requests that GOV.UK 2nd line support may receive regarding data.gov.uk.  <a href="https://guidance.data.gov.uk">Separate documentation</a> exists for publishers.</p>
<h2 id='users-and-publishers'>Users and Publishers</h2><p>Users have their own accounts and can login using either their username or email address.   A user can be a member of one or more publishing organisations, and can have either the role &lsquo;Admin&rsquo; or &lsquo;Editor&rsquo; for each organisation.  Users with &lsquo;Admin&rsquo; status can add/remove users from the organisation for which they are an admin.  They only have &lsquo;admin&rsquo; rights on their own organisation, contrasted to a &lsquo;sysadmin&rsquo; who has admin rights across all organisations.</p>
<h3 id='find-a-user'>Find a user</h3><p>There is a <a href="https://ckan.publishing.service.gov.uk/user">user list</a> which can be used to locate a user account.  This is useful in cases where a publisher does not know their username or no longer has access to their registered email account.  This list is only accessible when logged in as a sysadmin.</p>
<h3 id='create-a-user-account'>Create a user account</h3><p>There are two routes for creating an new account for a new user:</p>

<ol>
<li>A publishing organisation&rsquo;s &lsquo;admin&rsquo; user(s) can invite new users to create an account.  The admin user should <a href="https://guidance.data.gov.uk/publish_and_manage_data/get_and_manage_accounts/#add-or-remove-editors-and-admins">follow these instructions</a> to invite the new user to join. We should encourage this approach as the organisation admin is best placed to know whether or not the new user should have access, as well as reducing the number of requests to 2nd line support.</li>
<li>A sysadmin user (e.g. 2nd line) can create an account for the new user. This should only be done if the organisation has no admins, and if we can verify the authenticity of the request.

<ul>
<li>Follow the instructions in <a href="#assign-users-to-publishers-setting-user-permissions">Assign users to publishers</a> inputting the user&rsquo;s email address instead of their username.</li>
<li>An invite email is generated and sent to the publisher.</li>
</ul></li>
</ol>

<blockquote>
<p>An account should only be created if the user intends to publish on data.gov.uk.  Previously users have been able to register accounts to follow publishers.  This is no longer offered.</p>
</blockquote>
<h3 id='update-a-user-account-email-address'>Update a user account email address</h3><p>Since CKAN was upgraded users have needed to login using their email address instead of a username.  Some users have changed their email address and as such are no longer able to login to data.gov.uk. In order to update the email address associated with a user&rsquo;s account:</p>

<ol>
<li>Login to <a href="https://ckan.publishing.service.gov.uk">CKAN</a> as a sysadmin user (credentials are available in the <code>govuk-secrets</code> password store, under <code>datagovuk/ckan</code>).</li>
<li>Click the &lsquo;Publishers&rsquo; button in the header.</li>
<li>Search for the user&rsquo;s publishing organisation and click on it.</li>
<li>Click on the &lsquo;Manage&rsquo; button.</li>
<li>Click on the &lsquo;Members&rsquo; tab.</li>
<li>Click on the user&rsquo;s username in the list.</li>
<li>Click on the &lsquo;Manage&rsquo; button.</li>
<li>Fill in the email field with the user&rsquo;s new email address.</li>
<li>Enter the password you used to log in to CKAN in the &lsquo;Sysadmin password&rsquo; field.</li>
<li>Set a new password for the user.</li>
<li>Click &lsquo;Update profile&rsquo;.</li>
<li>Reply to the user to tell them that their email address has been changed, what the new password you set is and strongly advise them to change the password when they log in.</li>
</ol>
<h3 id='create-a-publishing-organisation'>Create a publishing organisation</h3>
<ol>
<li>Login to <a href="https://ckan.publishing.service.gov.uk">CKAN</a> as a sysadmin user (credentials are available in the <code>govuk-secrets</code> password store, under <code>datagovuk/ckan</code>).</li>
<li>Click the &lsquo;Publishers&rsquo; button in the header.</li>
<li>Click &lsquo;Add Publisher&rsquo; and complete the form.</li>
<li>Ensure that a publishing user has been assigned as an &lsquo;Admin&rsquo; for this organisation (this would normally be the person who makes the request, so they can then add further &lsquo;Editor&rsquo; users without needing to contact support).</li>
</ol>

<blockquote>
<p>Check the authenticity of a request before adding a user as a publishing admin (i.e. make sure they actually belong to the department they want to publish for, bearing in mind that some parent organisations may publish on behalf of child organisations, e.g. BEIS can publish for the Civil Nuclear Police Authority).</p>
</blockquote>
<h3 id='assign-users-to-publishers-setting-user-permissions'>Assign users to publishers (setting user permissions)</h3>
<ol>
<li>Login to <a href="https://ckan.publishing.service.gov.uk">CKAN</a> as a sysadmin user (credentials are available in the <code>govuk-secrets</code> password store, under <code>datagovuk/ckan</code>).</li>
<li>Navigate to the relevant page for the publisher (use the &lsquo;Publishers&rsquo; button in the header).</li>
<li>Click the &lsquo;Manage&rsquo; button.</li>
<li>Click onto the &lsquo;Members&rsquo; tab, then the &lsquo;Add Member&rsquo; button.</li>
<li>Add the user&rsquo;s existing account, or enter their email address to send them an invite, ensuring you select the relevant role for the user (either admin or editor).</li>
</ol>

<blockquote>
<p>Users should first be guided to request addition by an admin of their organisation, if possible.  This is to reduce the burden of these requests on the 2nd line team and to ensure only those with the correct authority are actually added as publishers.</p>
<p>Check the authenticity of a request before adding a user as a publisher (i.e. make sure they actually belong to the department they want to publish for, bearing in mind that some parent organisations may publish on behalf of child organisations, e.g. BEIS can publish for the Civil Nuclear Police Authority).</p>
</blockquote>
<h2 id='datasets'>Datasets</h2><h3 id='delete-or-withdraw-a-dataset'>Delete or withdraw a dataset</h3><p>Users are not permitted to remove their own datasets.  There are a <a href="https://guidance.data.gov.uk/publish_and_manage_data/managing_published_data/#managing-published-data">limited number of circumstances</a> in which a dataset will be withdrawn.  This is to be done by 2nd line, following a request from the publisher.  Datasets are never hard-deleted (known as &ldquo;purged&rdquo; in CKAN), instead they are marked as &ldquo;withdrawn&rdquo; (a soft-deletion), which removes them from the Find interface but allows them to be viewed through the publishing interface (CKAN).</p>

<blockquote>
<p>Before making any deletions, you should check that the person making the request actually belongs to the organisation who own the document (or are from a superseding department, e.g. someone from BEIS could request a withdrawal for a dataset published by BIS).</p>
</blockquote>
<h4 id='deleting-a-single-dataset'>Deleting a single dataset</h4>
<ol>
<li>Login to <a href="https://ckan.publishing.service.gov.uk">CKAN</a> as a sysadmin user (credentials are available in the <code>govuk-secrets</code> password store, under <code>datagovuk/ckan</code>).</li>
<li>Navigate to the relevant dataset (use the &lsquo;Datasets&rsquo; button in the header).</li>
<li>Click the &lsquo;Manage&rsquo; button.</li>
<li>Click the red &lsquo;Delete&rsquo; button.</li>
<li>Once withdrawn, it will take up to 30 minutes to sync across to Find and clear the cache.</li>
</ol>
<h4 id='bulk-deleting-datasets'>Bulk deleting datasets</h4><p>Sometimes a publisher will request a large deletion of datasets.  In these cases, you can bulk withdraw the datasets using the instructions contained in the <a href="/manual/data-gov-uk-supporting-ckan.html#deleting-a-dataset">supporting CKAN</a> documentation.  Refer to the instructions for &lsquo;Deleting a dataset&rsquo; (which is a soft-delete).  <strong>Do not purge the dataset - this is a hard-delete.</strong></p>
<h3 id='a-dataset-is-wrong-in-some-way'>A dataset is wrong in some way</h3><p>Responsibility for individual datasets lies with the publishing organisation.  Unless it&rsquo;s clearly a data.gov.uk problem (eg, a dataset page is returning an error response when it shouldn&rsquo;t be), users who report a problem with a dataset should be directed to the publisher.</p>
<p>This is a generic response for such cases:</p>

<blockquote>
<p>Thanks for getting in touch.</p>
<p>Individual datasets are the responsibility of the publishing organisation, rather than the data.gov.uk team. This means that you’ll need to get in touch with the publishing organisation directly to request any changes to the dataset.</p>
<p>Contact details for each dataset are towards the bottom of the dataset page.</p>
<p>I hope that helps. I’ll close this ticket now.</p>
</blockquote>
<h3 id='different-number-of-datasets-in-ckan-app-to-find'>Different number of datasets in <a href="/apps/ckanext-datagovuk.html">CKAN-app</a> to <a href="/apps/datagovuk_find.html">Find</a></h3><p>Determine the number of datasets in CKAN using the API:</p>
<p><a href="https://data.gov.uk/api/3/search/dataset">https://data.gov.uk/api/3/search/dataset</a></p>
<p>Determine the number of datasets in the Publish Postgres database using the Rails console.</p>
<div class="highlight"><pre class="highlight plaintext"><code>cf ssh publish-data-beta-production
/tmp/lifecycle/launcher /home/vcap/app 'rails console' ''
&gt;&gt;&gt; Dataset.count
</code></pre></div><p>If these numbers match, but the number of datasets served on Find is still different, identify the number of published in the Publish Postgres database.</p>
<div class="highlight"><pre class="highlight plaintext"><code>cf ssh publish-data-beta-production
/tmp/lifecycle/launcher /home/vcap/app 'rails console' ''
&gt;&gt;&gt; Dataset.published.count
</code></pre></div><p>With the current set up, all datasets that are available through the CKAN API will be marked as public in the Publish Postgres database.  Therefore, if you get a different number of datasets, you should mark them all as published in the Publish Postgres database.</p>
<div class="highlight"><pre class="highlight plaintext"><code>cf ssh publish-data-beta-production
/tmp/lifecycle/launcher /home/vcap/app 'rails console' ''
&gt;&gt;&gt; Dataset.update(status: 'published')
</code></pre></div><p>A <a href="/manual/data-gov-uk-operations.html#reindexing-find">reindex</a> must then be done to update the status with the Elastic instance that serves Find.</p>
<h3 id='datasets-published-in-ckan-are-not-appearing-on-find'>Datasets published in CKAN are not appearing on Find</h3><p>Check the Sidekiq queue (see <a href="/manual/data-gov-uk-monitoring.html#sidekiq-publish">monitoring section</a>) length to ensure the queue length is not too long.  You should not be seeing more jobs than the number of datasets in CKAN.</p>
<p>If the queue is too long, you should <a href="https://github.com/mperham/sidekiq/wiki/API">clear the queue</a>.  The next sync process will repopulate the queue with any relevant datasets that require updating.</p>
<h3 id='accessing-withdrawn-content'>Accessing withdrawn content</h3><p>Sometimes we get queries from users asking for data that is no longer publicly available, e.g. a withdrawn dataset.</p>
<h4 id='if-the-withdrawn-content-was-a-dataset'>If the withdrawn content was a dataset</h4><p>Ask the user to email the organisation that originally published the dataset. You can find an email address for the organisation on CKAN.</p>
<h4 id='if-the-withdrawn-content-was-a-publication'>If the withdrawn content was a publication</h4><p>If the content was published under http://data.gov.uk/library, this was part of the former Drupal-based data.gov.uk publishing application, which is no longer being hosted on DGU.</p>
<p>Whilst we do have a backup of the old bytemark server and can access the publications in an emergency, we recommend directing users to the relevant team in government, as the original documents were often incomplete and/or outdated.</p>
<h2 id='schema-vocabulary-definitions'>Schema vocabulary definitions</h2><h3 id='add-a-schema-vocabulary-definition'>Add a schema vocabulary definition</h3><p>Users are not permitted to add their own schema vocabulary definitions.
This is to be done by 2nd line, following a request from the publisher.</p>

<ol>
<li>Add the new schema vocabulary definition to the <a href="schemas">schemas</a></li>
<li>Add the new schema vocabulary definition to the <a href="test-schemas">corresponding test</a></li>
</ol>
<p>The format is:</p>
<div class="highlight"><pre class="highlight plaintext"><code>"&lt;random UUID&gt;": "&lt;schema vocabulary definition title&gt; - &lt;schema vocabulary definition url&gt;"`
</code></pre></div><p>You can generate a <code>UUID</code> in <code>irb</code> or <code>pry</code>:</p>
<div class="highlight"><pre class="highlight shell"><code><span class="nv">$ </span>pry
<span class="o">[</span>1] pry<span class="o">(</span>main<span class="o">)&gt;</span> require <span class="s1">'securerandom'</span>
<span class="o">=&gt;</span> <span class="nb">true</span>
<span class="o">[</span>2] pry<span class="o">(</span>main<span class="o">)&gt;</span> SecureRandom.uuid
<span class="o">=&gt;</span> <span class="s2">"14104757-303a-48ad-8eff-bfbe320b0e0a"</span>
</code></pre></div>
<blockquote>
<p><strong>Note</strong></p>
<p>The added schema will appear in the Schema/Vocabulary dropdown in <a href="https://ckan.publishing.service.gov.uk/dataset/new">https://ckan.publishing.service.gov.uk/dataset/new</a>.</p>
</blockquote>
<h2 id='harvesting'>Harvesting</h2><p>Harvesting is where publishers can automatically import their data to data.gov.uk without having to manually enter it into the web interface. They can be set up to run automatically at specified periods, or run manually on-demand.</p>
<p>See the <a href="/manual/data-gov-uk-supporting-ckan.html#harvesting">&ldquo;Harvesting&rdquo; section in &ldquo;Support tasks for CKAN&rdquo;</a> for troubleshooting.</p>
<h2 id='map-previews-issues'>Map previews issues</h2><p>Datagovuk Find supports links to show a map preview, but sometimes the map link is not available.
There may be a number of reasons for this:</p>

<ol>
<li>The harvest source is broken.</li>
<li>The harvest source WMS version is incompatible.

<ul>
<li>Only 1.1.1 or 1.3.0 WMS versions are supported</li>
<li>the error should be available to users from the harvest jobs page:</li>
<li><code>https://ckan.publishing.service.gov.uk/harvest/&lt;harvest name&gt;/job/&lt;harvest job id&gt;</code></li>
<li>if the error is not shown you can investigate the harvest source by using the ckan api:</li>
<li><code>https://ckan.publishing.service.gov.uk/api/action/package_show?id=&lt;id or name of dataset&gt;</code></li>
<li>the URL in each resource should provide a version number which might be part of the link</li>
</ul></li>
</ol>
<p>In both of these cases 2ndine should ask the user to fix the issue on their harvest server.</p>
<h2 id='organogram-publishing'>Organogram Publishing</h2><p>Organograms are files that allow the people structure of an organisation to be visualised.  They are split into two files: one for senior staff (grades SCS1, SCS2 and SCS3, or equivalent) and another for junior staff (all other grades).  The senior staff file is more detailed than the junior staff file, with staff names included for posts classified as grades SCS2 and SCS3.</p>
<p>Organograms are the only datasets in data.gov.uk where we host the data itself rather than linking to an external resource.  The data files are hosted in a S3 bucket (named <code>datagovuk-integration-ckan-organogram</code>, <code>datagovuk-staging-ckan-organogram</code> or <code>datagovuk-production-ckan-organogram</code>, depending on the environment).</p>
<p>Read <a href="https://guidance.data.gov.uk/publish_and_manage_data/harvest_or_add_data/add_data/#publishing-organograms">publishing organograms</a> to find out how to upload new organograms and datasets. You can direct user queries to that guidance.</p>
<h3 id='xls-to-csv-conversion'>XLS to CSV Conversion</h3><p>Publishers upload their organograms as a Excel (XLS) file that contains macros.  A script is run which converts these to the two CSV files (junior staff and senior staff).</p>

<blockquote>
<p>Publishers <strong>must</strong> select the correct &lsquo;Schema Vocabulary&rsquo; for their organogram dataset (i.e. one of the two &lsquo;organisation structure&rsquo; values) in order for the upload option to become available and for the XLS-to-CSV conversion to run.</p>
</blockquote>
<h3 id='dataset-analytics-requests'>Dataset Analytics requests</h3><p>It is possible to access analytics for datasets. If a user requests analytics for datasets, we can provide them with access to an analytics dashboard. Assign tickets like this to Martin Lugton or another member of the Platform Health product team.</p>
<h2 id='revision-log'>Revision log</h2><p>There is a <a href="https://ckan.publishing.service.gov.uk/revision">revision log</a> which shows the most recent edits to CKAN datasets, harvester and users performed by all users.</p>


  <div class='related-content'>

    <h3>More in the data.gov.uk section</h3>

    <div class='govuk-grid-row'>
        <div class='govuk-grid-column-one-half'>
          <h4>Learn</h4>

          <ul class="govuk-list">
            <li><a href="/manual/data-gov-uk-architecture.html">Architecture of data.gov.uk</a></li>
            <li><a href="/manual/data-gov-uk-contracts-archive.html">Data.gov.uk Contracts Archive</a></li>
            <li><a href="/manual/data-gov-uk-map-previews.html">WMS map previews on data.gov.uk</a></li>
          </ul>
        </div>

        <div class='govuk-grid-column-one-half'>
          <h4>How to...</h4>

          <ul class="govuk-list">
            <li><a href="/manual/data-gov-uk-deployment.html">Deployments for data.gov.uk</a></li>
            <li><a href="/manual/data-gov-uk-monitoring.html">Monitor data.gov.uk</a></li>
            <li><a href="/manual/data-gov-uk-operations.html">Operation of data.gov.uk</a></li>
            <li><a href="/manual/data-gov-uk-supporting-ckan.html">Support tasks for CKAN</a></li>
          </ul>
        </div>

    </div>
</div>


              <div data-module='page-expiry' data-last-reviewed-on="2020-12-15">
    <div class='page-expiry--not-expired'>
      This page was last reviewed on 15 June 2020.

        It needs to be reviewed again on 15 December 2020
        by the page owner <a href="">#govuk-2ndline</a>
        .
    </div>

    <div class='page-expiry--expired'>
      This page was set to be reviewed before 15 December 2020
       by the page owner <a href="">#govuk-2ndline</a>.
      This might mean the content is out of date.
    </div>
  </div>

          </main>

          <aside>
              <ul class="contribution-banner">
                <li><a href="https://github.com/alphagov/govuk-developer-docs/blob/master/source/manual/data-gov-uk-2nd-line.html.md">View source</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs/issues/new?labels=bug&amp;title=Re:%20'Common%202nd%20line%20support%20tasks%20for%20data.gov.uk'&amp;body=Problem%20with%20'Common%202nd%20line%20support%20tasks%20for%20data.gov.uk'%20(https://docs.publishing.service.gov.uk/manual/data-gov-uk-2nd-line.html)">Report problem</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs">GitHub Repo</a></li>
              </ul>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">


      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="/javascripts/application.js"></script>
  </body>
</html>
